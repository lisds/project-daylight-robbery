

<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>Seasonal Changes &#8212; Project Daylight Robbery</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'pages/seasonal-changes';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Seasonal Changes Regression Analysis" href="linear-regression.html" />
    <link rel="prev" title="Aviation Security (SO18) Borough" href="aviation-security.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="../_static/logo.png" class="logo__image only-light" alt="Project Daylight Robbery - Home"/>
    <script>document.write(`<img src="../_static/logo.png" class="logo__image only-dark" alt="Project Daylight Robbery - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Introduction
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Exploration</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="basic-exploration.html">Exploring the Recorded Crime Datasets</a></li>
<li class="toctree-l1"><a class="reference internal" href="comparison.html">Consistency across Borough, Ward and LSOA</a></li>
<li class="toctree-l1"><a class="reference internal" href="aviation-security.html">Aviation Security (SO18) Borough</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 current active"><a class="current reference internal" href="#">Seasonal Changes</a></li>
<li class="toctree-l1"><a class="reference internal" href="linear-regression.html">Seasonal Changes Regression Analysis</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Usage</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="multi_index.html">MultiIndex - a short guide</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Incomplete analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="sankey_trial.html">Sankey Diagrams</a></li>
<li class="toctree-l1"><a class="reference internal" href="MultiRegress.html">Weather - Multiple Regression</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/lisds/project-daylight-robbery" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/lisds/project-daylight-robbery/issues/new?title=Issue%20on%20page%20%2Fpages/seasonal-changes.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/pages/seasonal-changes.Rmd" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.Rmd</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Seasonal Changes</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rape">Rape</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bicycle-theft">Bicycle Theft</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#all-offences">All Offences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attempting-a-better-permutation-test">Attempting a ‘better’ permutation test</a></li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="seasonal-changes">
<h1>Seasonal Changes<a class="headerlink" href="#seasonal-changes" title="Permalink to this heading">#</a></h1>
<p>Coming into this project one of the questions we had was what affect daylight and seasonality has on crime in London. We are particularly interested in certain crimes where individuals may perceive higher risk during hours of darkness, such as rape and other violent offences, and whether this perception holds true.</p>
<p>We do not have data on the time at which crimes took place, which limits our ability to investigate the effect of daylight versus darkness on the number of crimes. However, British Summer Time (BST) creates a change in daylight hours which we will use to look at a seasonal differences in the number of crimes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">projtools.data</span> <span class="kn">import</span> <span class="n">Data</span>
<span class="kn">from</span> <span class="nn">projtools</span> <span class="kn">import</span> <span class="n">stats</span>

<span class="n">data</span> <span class="o">=</span> <span class="n">Data</span><span class="p">()</span>
<span class="n">idx</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">IndexSlice</span>
<span class="n">rng</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">default_rng</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/British_Summer_Time">BST starts on the last Sunday of March and ends on the last Sunday of October</a>. For our purposes we will consider April - October summer and November - March winter. This does give us an uneven number of months in each group, but we can avoid issues resulting from this by using per month summary stats and permutation tests to check for significance of differences.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_months</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;04&quot;</span><span class="p">,</span><span class="s2">&quot;05&quot;</span><span class="p">,</span><span class="s2">&quot;06&quot;</span><span class="p">,</span><span class="s2">&quot;07&quot;</span><span class="p">,</span><span class="s2">&quot;08&quot;</span><span class="p">,</span><span class="s2">&quot;09&quot;</span><span class="p">,</span><span class="s2">&quot;10&quot;</span><span class="p">]</span>
<span class="n">winter_months</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;01&quot;</span><span class="p">,</span><span class="s2">&quot;02&quot;</span><span class="p">,</span><span class="s2">&quot;03&quot;</span><span class="p">,</span><span class="s2">&quot;11&quot;</span><span class="p">,</span><span class="s2">&quot;12&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<p>Here, we exclude years 2010 and 2023 as both years do not contain all of the winter months.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">borough</span>
              <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[</span><span class="s2">&quot;2011&quot;</span><span class="p">:</span><span class="s2">&quot;2022&quot;</span><span class="p">,</span> <span class="n">summer_months</span><span class="p">]])</span>
<span class="n">winter</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">borough</span>
              <span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">idx</span><span class="p">[</span><span class="s2">&quot;2011&quot;</span><span class="p">:</span><span class="s2">&quot;2022&quot;</span><span class="p">,</span> <span class="n">winter_months</span><span class="p">]])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winter</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th></th>
      <th></th>
      <th>year</th>
      <th colspan="5" halign="left">2011</th>
      <th colspan="5" halign="left">2012</th>
      <th>...</th>
      <th colspan="5" halign="left">2021</th>
      <th colspan="5" halign="left">2022</th>
    </tr>
    <tr>
      <th></th>
      <th></th>
      <th>month</th>
      <th>01</th>
      <th>02</th>
      <th>03</th>
      <th>11</th>
      <th>12</th>
      <th>01</th>
      <th>02</th>
      <th>03</th>
      <th>11</th>
      <th>12</th>
      <th>...</th>
      <th>01</th>
      <th>02</th>
      <th>03</th>
      <th>11</th>
      <th>12</th>
      <th>01</th>
      <th>02</th>
      <th>03</th>
      <th>11</th>
      <th>12</th>
    </tr>
    <tr>
      <th>category</th>
      <th>offence</th>
      <th>borough</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">Arson and Criminal Damage</th>
      <th>Arson</th>
      <th>Barking and Dagenham</th>
      <td>5.0</td>
      <td>12.0</td>
      <td>13.0</td>
      <td>13.0</td>
      <td>5.0</td>
      <td>10.0</td>
      <td>4.0</td>
      <td>9.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>...</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>6.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <th>Criminal Damage</th>
      <th>Barking and Dagenham</th>
      <td>173.0</td>
      <td>158.0</td>
      <td>182.0</td>
      <td>150.0</td>
      <td>161.0</td>
      <td>136.0</td>
      <td>113.0</td>
      <td>174.0</td>
      <td>117.0</td>
      <td>130.0</td>
      <td>...</td>
      <td>100.0</td>
      <td>104.0</td>
      <td>80.0</td>
      <td>109.0</td>
      <td>116.0</td>
      <td>126.0</td>
      <td>110.0</td>
      <td>116.0</td>
      <td>101.0</td>
      <td>99.0</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">Burglary</th>
      <th>Burglary Business and Community</th>
      <th>Barking and Dagenham</th>
      <td>50.0</td>
      <td>52.0</td>
      <td>65.0</td>
      <td>64.0</td>
      <td>53.0</td>
      <td>46.0</td>
      <td>43.0</td>
      <td>64.0</td>
      <td>68.0</td>
      <td>81.0</td>
      <td>...</td>
      <td>21.0</td>
      <td>18.0</td>
      <td>14.0</td>
      <td>20.0</td>
      <td>14.0</td>
      <td>19.0</td>
      <td>29.0</td>
      <td>30.0</td>
      <td>22.0</td>
      <td>23.0</td>
    </tr>
    <tr>
      <th>Domestic Burglary</th>
      <th>Barking and Dagenham</th>
      <td>165.0</td>
      <td>122.0</td>
      <td>155.0</td>
      <td>167.0</td>
      <td>181.0</td>
      <td>184.0</td>
      <td>149.0</td>
      <td>195.0</td>
      <td>187.0</td>
      <td>165.0</td>
      <td>...</td>
      <td>70.0</td>
      <td>90.0</td>
      <td>71.0</td>
      <td>87.0</td>
      <td>91.0</td>
      <td>81.0</td>
      <td>67.0</td>
      <td>77.0</td>
      <td>68.0</td>
      <td>87.0</td>
    </tr>
    <tr>
      <th>Drug Offences</th>
      <th>Drug Trafficking</th>
      <th>Barking and Dagenham</th>
      <td>9.0</td>
      <td>3.0</td>
      <td>8.0</td>
      <td>13.0</td>
      <td>3.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>9.0</td>
      <td>7.0</td>
      <td>...</td>
      <td>12.0</td>
      <td>11.0</td>
      <td>12.0</td>
      <td>12.0</td>
      <td>10.0</td>
      <td>14.0</td>
      <td>11.0</td>
      <td>19.0</td>
      <td>13.0</td>
      <td>15.0</td>
    </tr>
    <tr>
      <th>...</th>
      <th>...</th>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>Possession of Weapons</th>
      <th>Possession of Firearm with Intent</th>
      <th>London Heathrow and London City Airports</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">Miscellaneous Crimes Against Society</th>
      <th rowspan="3" valign="top">Aiding Suicide</th>
      <th>Redbridge</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Sutton</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Waltham Forest</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
    <tr>
      <th>Soliciting for Prostitution</th>
      <th>Wandsworth</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
    </tr>
  </tbody>
</table>
<p>1745 rows × 60 columns</p>
</div></div></div>
</div>
<section id="rape">
<h2>Rape<a class="headerlink" href="#rape" title="Permalink to this heading">#</a></h2>
<p>Now, we select a particular offence (in this case rape), sum all of the rows, then group and sum the months together. This gives us the total number of recorded rapes in each month from 2011 to 2022.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_rape</span> <span class="o">=</span> <span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Rape&quot;</span><span class="p">],</span> <span class="p">:]</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">T</span>
                     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">summer_rape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>month
07    7002.0
10    6865.0
06    6665.0
05    6457.0
09    6456.0
08    6436.0
04    5774.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Doing the same for winter, we can see that it seems most of the months with the greatest number of crimes fall in the summer group.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winter_rape</span> <span class="o">=</span> <span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Rape&quot;</span><span class="p">],</span> <span class="p">:]</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">T</span>
                     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">winter_rape</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>month
11    6621.0
03    6492.0
01    6240.0
12    6054.0
02    5882.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>Working out the average summer month and average winter month shows that there is a greater number of rape crimes recorded in the average summer month.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summer month average: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">summer_rape</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">summer_months</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Winter month average: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">winter_rape</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">winter_months</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summer month average: 6522.142857142857
Winter month average: 6257.8
</pre></div>
</div>
</div>
</div>
<p>Now we run a permutation test which shuffles the months and calculates the difference in means over 10,000 iterations. It returns a p-value which gives us the probability that the fake difference in means is greater than the observed difference.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">(</span><span class="n">summer_rape</span><span class="p">,</span> <span class="n">winter_rape</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s1">&#39;less&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264.3428571428567,
 array([174.51428571, 168.        , 183.08571429, ..., 160.45714286,
        167.65714286,  37.02857143]),
 0.1248)
</pre></div>
</div>
</div>
</div>
<p>The result of 0.1168 shows us that the observed difference we see would be fairly surprising in the null world - about a 1 in 10 chance. This means that we can be fairly confident that there is a meaningful difference in the recorded crimes between the summer and winter groups but it does not give us any indication as to whether this is down to shifting daylight hours resulting from the change from GMT to BST and vice versa.</p>
</section>
<section id="bicycle-theft">
<h2>Bicycle Theft<a class="headerlink" href="#bicycle-theft" title="Permalink to this heading">#</a></h2>
<p>In our initial exploration we noticed that Bicycle Theft was an offence that appeared to have considerable seasonal variation. This would be unsurprising, given that in the winter the weather is less appealing, less people cycle which presumably means less bikes locked up in public places where opportunistic theft is likely to occur.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_bike_theft</span> <span class="o">=</span> <span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Bicycle Theft&quot;</span><span class="p">],</span> <span class="p">:]</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">T</span>
                     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">summer_bike_theft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>month
07    26408.0
09    24720.0
08    24716.0
10    24256.0
06    23929.0
05    22295.0
04    18507.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">winter_bike_theft</span> <span class="o">=</span> <span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Bicycle Theft&quot;</span><span class="p">],</span> <span class="p">:]</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">T</span>
                     <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                     <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                     <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
<span class="n">winter_bike_theft</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>month
11    19136.0
03    16458.0
01    13717.0
02    12934.0
12    12896.0
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can see that from November through to February there is a considerable slump in recorded bike thefts from the peak in July. This is reflected in the differences in the means.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Summer month average: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">summer_bike_theft</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">summer_months</span><span class="p">)))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Winter month average: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">winter_bike_theft</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">winter_months</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Summer month average: 23547.285714285714
Winter month average: 15028.2
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">(</span><span class="n">summer_bike_theft</span><span class="p">,</span> <span class="n">winter_bike_theft</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(8519.085714285713,
 array([ 2166.62857143,  2559.88571429, -1884.57142857, ...,
        -3059.88571429,  -688.68571429,   833.6       ]),
 0.0025)
</pre></div>
</div>
</div>
</div>
<p>The permutation test shows that the observed difference would be an extremely surprising result (~1 in 400) in the null world. So we can be very confident that there is a meaningful difference between the summer and the winter months. However, as explained before, this does not tell us whether the time zone change is a reason for this.</p>
</section>
<section id="all-offences">
<h2>All Offences<a class="headerlink" href="#all-offences" title="Permalink to this heading">#</a></h2>
<p>Based on the principles set out above, we have now worked out the difference in average winter and summer months for all offences. This helps us pick out offences that are worth further investigation.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">offences</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">borough</span>
                <span class="o">.</span><span class="n">index</span>
                <span class="o">.</span><span class="n">get_level_values</span><span class="p">(</span><span class="s2">&quot;offence&quot;</span><span class="p">)</span>
                <span class="o">.</span><span class="n">unique</span><span class="p">())</span>

<span class="n">diff_dict</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">()</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">offence</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">offences</span><span class="p">):</span>
    <span class="n">summer_month_offences</span> <span class="o">=</span> <span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="n">offence</span><span class="p">],</span> <span class="p">:]</span>
                                   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                                   <span class="o">.</span><span class="n">T</span>
                                   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                                   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                                   <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    
    <span class="n">winter_month_offences</span> <span class="o">=</span> <span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="n">offence</span><span class="p">],</span> <span class="p">:]</span>
                                   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                                   <span class="o">.</span><span class="n">T</span>
                                   <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                                   <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                                   <span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">))</span>
    
    <span class="n">summer_mean</span> <span class="o">=</span> <span class="n">summer_month_offences</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">summer_months</span><span class="p">)</span>
    <span class="n">winter_mean</span> <span class="o">=</span> <span class="n">winter_month_offences</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">winter_months</span><span class="p">)</span>
    
    <span class="n">diff_dict</span><span class="p">[</span><span class="n">offence</span><span class="p">]</span> <span class="o">=</span> <span class="n">summer_mean</span> <span class="o">-</span> <span class="n">winter_mean</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can get a sense of which offences have the biggest seasonal changes.</p>
<ul class="simple">
<li><p>Negative values = more recorded crimes in <strong>winter</strong> months</p></li>
<li><p>Positive values = more recorded crimes in <strong>summer</strong> months</p></li>
</ul>
<p>We can see that there are a number of crimes with very strong biases in each group of months. Although there are more offences with a strong bias towards summer months. There are some offences which we might expect to have a bias towards either winter or summer but there are also some unexpected offences such as <strong>Theft from Person</strong> and <strong>Theft from a Motor Vehicle</strong> which have a stronger bias towards winter than one might expect.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">diff_dict</span><span class="o">.</span><span class="n">sort_values</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Domestic Burglary                                    -9034.857143
Theft from Person                                    -3803.514286
Theft from a Motor Vehicle                           -1237.514286
Historical Fraud and Forgery                          -577.057143
Interfering with a Motor Vehicle                      -271.828571
Obscene Publications                                  -167.371429
Robbery of Business Property                          -140.400000
Robbery of Personal Property                           -86.514286
Other Forgery                                          -73.457143
Handling Stolen Goods                                  -34.857143
Other Firearm Offences                                 -24.142857
Possession of False Documents                          -22.742857
Soliciting for Prostitution                            -21.514286
Burglary Business and Community                        -16.285714
Disclosure, Obstruction, False or Misleading State     -10.714286
Making, Supplying or Possessing Articles for use i      -8.628571
Profitting From or Concealing Proceeds of Crime         -7.285714
Exploitation of Prostitution                            -5.028571
Absconding from Lawful Custody                          -1.200000
Aiding Suicide                                          -0.857143
Other Knife Offences                                    -0.228571
Concealing an Infant Death Close to Birth                0.085714
Offender Management Act                                  0.400000
Perjury                                                  0.885714
Bigamy                                                   0.971429
Wildlife Crime                                           1.428571
Fraud or Forgery Associated with Driver Records          1.542857
Forgery or Use of Drug Prescription                      4.428571
Homicide                                                10.485714
Bail Offences                                           12.085714
Going Equipped for Stealing                             19.800000
Possession of Firearm with Intent                       26.942857
Possession of Firearms Offences                         27.171429
Violent Disorder                                        30.000000
Dangerous Driving                                       42.000000
Perverting Course of Justice                            44.400000
Aggravated Vehicle Taking                               54.314286
Drug Trafficking                                        90.657143
Possession of Article with Blade or Point              145.314286
Possession of Other Weapon                             214.285714
Other Notifiable Offences                              231.542857
Rape                                                   264.342857
Threat or Possession With Intent to Commit Crimina     309.771429
Arson                                                  332.171429
Shoplifting                                            394.428571
Possession of Drugs                                    579.114286
Other Offences Against the State, or Public Order      706.485714
Other Sexual Offences                                  876.000000
Theft or Taking of a Motor Vehicle                    1105.771429
Racially or Religiously Aggravated Public Fear, Al    1548.742857
Other Theft                                           2290.771429
Criminal Damage                                       2882.171429
Public Fear Alarm or Distress                         4410.657143
Violence with Injury                                  6318.114286
Violence without Injury                               6580.714286
Bicycle Theft                                         8519.085714
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>As we’ve done with Rape and Bicycle Theft above, we can run permutation tests on the offences which are showing significant differences to see how surprising these would be in the null world.</p>
<p>We’ve chosen to only select offences which have an absolute difference greater than 200.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">decent_diff</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">diff_dict</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">200</span>
<span class="n">defcent_diffs</span> <span class="o">=</span> <span class="n">diff_dict</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">decent_diff</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;offence&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;actual_diff&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;p_value&quot;</span><span class="p">:</span> <span class="p">[],</span> <span class="s2">&quot;crimes&quot;</span><span class="p">:</span> <span class="p">[]}</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">defcent_diffs</span><span class="p">):</span>
    
    <span class="n">offence</span> <span class="o">=</span> <span class="n">defcent_diffs</span><span class="o">.</span><span class="n">keys</span><span class="p">()[</span><span class="n">index</span><span class="p">]</span>
    
    <span class="n">summer_crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="n">offence</span><span class="p">],</span> <span class="p">:]</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                          <span class="o">.</span><span class="n">T</span>
                          <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    
    <span class="n">winter_crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="n">offence</span><span class="p">],</span> <span class="p">:]</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                          <span class="o">.</span><span class="n">T</span>
                          <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">())</span>
    
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;offence&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">offence</span><span class="p">)</span>
    <span class="n">results</span><span class="p">[</span><span class="s2">&quot;crimes&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">summer_crime</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">+</span> <span class="n">winter_crime</span><span class="o">.</span><span class="n">sum</span><span class="p">())</span>

    <span class="k">if</span> <span class="n">value</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">actual_diff</span><span class="p">,</span> <span class="n">fake_diffs</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">(</span><span class="n">summer_crime</span><span class="p">,</span> <span class="n">winter_crime</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>

        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;actual_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_diff</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;p_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
        
    <span class="k">elif</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">actual_diff</span><span class="p">,</span> <span class="n">fake_diffs</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">stats</span><span class="o">.</span><span class="n">permutation_test</span><span class="p">(</span><span class="n">summer_crime</span><span class="p">,</span> <span class="n">winter_crime</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;greater&quot;</span><span class="p">)</span>
    
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;actual_diff&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">actual_diff</span><span class="p">)</span>
        <span class="n">results</span><span class="p">[</span><span class="s2">&quot;p_value&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">p_value</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Having sorted the p-values in ascending order, we can see some of the offences with the largest differences towards the top as we would expect. Offences such as Bicycle Theft, Public Fear Alarm or Distress, Domestic Burglary and Violence with Injury all have large actual differences and have very small p-values which suggests that these differences are surprising.</p>
<p>However, we can also see some offences with seemingly small differences that also have very small p-values. Having noticed this, we compared the number of crimes (observations) in “Threat or Possession With Intent to Commit Crinina” (small diff, small p-value) and Rape (small diff, larger p-value). It turns out that there are much more recorded Rape offences.</p>
<p>Based on that observation, I have added a column displaying the number of crimes:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">results</span><span class="p">)</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">by</span><span class="o">=</span><span class="s2">&quot;p_value&quot;</span><span class="p">)</span>
<span class="n">results_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>offence</th>
      <th>actual_diff</th>
      <th>p_value</th>
      <th>crimes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>6</th>
      <td>Threat or Possession With Intent to Commit Cri...</td>
      <td>309.771429</td>
      <td>0.0026</td>
      <td>21606.0</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Bicycle Theft</td>
      <td>8519.085714</td>
      <td>0.0033</td>
      <td>239972.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Domestic Burglary</td>
      <td>-9034.857143</td>
      <td>0.0043</td>
      <td>617744.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Public Fear Alarm or Distress</td>
      <td>4410.657143</td>
      <td>0.0053</td>
      <td>327805.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Racially or Religiously Aggravated Public Fear...</td>
      <td>1548.742857</td>
      <td>0.0062</td>
      <td>96094.0</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Other Offences Against the State, or Public Order</td>
      <td>706.485714</td>
      <td>0.0076</td>
      <td>75095.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Violence with Injury</td>
      <td>6318.114286</td>
      <td>0.0078</td>
      <td>845522.0</td>
    </tr>
    <tr>
      <th>0</th>
      <td>Arson</td>
      <td>332.171429</td>
      <td>0.0110</td>
      <td>24602.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Other Notifiable Offences</td>
      <td>231.542857</td>
      <td>0.0173</td>
      <td>16532.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Criminal Damage</td>
      <td>2882.171429</td>
      <td>0.0173</td>
      <td>680612.0</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Possession of Other Weapon</td>
      <td>214.285714</td>
      <td>0.0180</td>
      <td>28476.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Violence without Injury</td>
      <td>6580.714286</td>
      <td>0.0418</td>
      <td>1394397.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Theft from Person</td>
      <td>-3803.514286</td>
      <td>0.0494</td>
      <td>508153.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Other Sexual Offences</td>
      <td>876.000000</td>
      <td>0.0729</td>
      <td>129240.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Historical Fraud and Forgery</td>
      <td>-577.057143</td>
      <td>0.0758</td>
      <td>56251.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Theft or Taking of a Motor Vehicle</td>
      <td>1105.771429</td>
      <td>0.0953</td>
      <td>312598.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Rape</td>
      <td>264.342857</td>
      <td>0.1248</td>
      <td>76944.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Interfering with a Motor Vehicle</td>
      <td>-271.828571</td>
      <td>0.1834</td>
      <td>127690.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Theft</td>
      <td>2290.771429</td>
      <td>0.2378</td>
      <td>1369597.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Theft from a Motor Vehicle</td>
      <td>-1237.514286</td>
      <td>0.2700</td>
      <td>758327.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Shoplifting</td>
      <td>394.428571</td>
      <td>0.2750</td>
      <td>487549.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Possession of Drugs</td>
      <td>579.114286</td>
      <td>0.3776</td>
      <td>513893.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>If we remove offences with less than 80,000 observations we can see that we lose all of the offences with small differences and very small p-values. Even then we can still see the effect. “Racially or Religiously Aggravated Public Fear” has half the <code class="docutils literal notranslate"><span class="pre">actual_diff</span></code> of “Public Fear Alarm or Distress” and yet their p-values are very close. The reason being that “Racially or Religiously Aggravated Public Fear” has 1/3 the observations of “Public Fear Alarm or Distress”.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">results_df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">results_df</span><span class="p">[</span><span class="s2">&quot;crimes&quot;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">80000</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>offence</th>
      <th>actual_diff</th>
      <th>p_value</th>
      <th>crimes</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13</th>
      <td>Bicycle Theft</td>
      <td>8519.085714</td>
      <td>0.0033</td>
      <td>239972.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Domestic Burglary</td>
      <td>-9034.857143</td>
      <td>0.0043</td>
      <td>617744.0</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Public Fear Alarm or Distress</td>
      <td>4410.657143</td>
      <td>0.0053</td>
      <td>327805.0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Racially or Religiously Aggravated Public Fear...</td>
      <td>1548.742857</td>
      <td>0.0062</td>
      <td>96094.0</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Violence with Injury</td>
      <td>6318.114286</td>
      <td>0.0078</td>
      <td>845522.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Criminal Damage</td>
      <td>2882.171429</td>
      <td>0.0173</td>
      <td>680612.0</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Violence without Injury</td>
      <td>6580.714286</td>
      <td>0.0418</td>
      <td>1394397.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Theft from Person</td>
      <td>-3803.514286</td>
      <td>0.0494</td>
      <td>508153.0</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Other Sexual Offences</td>
      <td>876.000000</td>
      <td>0.0729</td>
      <td>129240.0</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Theft or Taking of a Motor Vehicle</td>
      <td>1105.771429</td>
      <td>0.0953</td>
      <td>312598.0</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Interfering with a Motor Vehicle</td>
      <td>-271.828571</td>
      <td>0.1834</td>
      <td>127690.0</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Other Theft</td>
      <td>2290.771429</td>
      <td>0.2378</td>
      <td>1369597.0</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Theft from a Motor Vehicle</td>
      <td>-1237.514286</td>
      <td>0.2700</td>
      <td>758327.0</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Shoplifting</td>
      <td>394.428571</td>
      <td>0.2750</td>
      <td>487549.0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Possession of Drugs</td>
      <td>579.114286</td>
      <td>0.3776</td>
      <td>513893.0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="attempting-a-better-permutation-test">
<h2>Attempting a ‘better’ permutation test<a class="headerlink" href="#attempting-a-better-permutation-test" title="Permalink to this heading">#</a></h2>
<p>The permutation test used above only shuffled the months themselves meaning the totals were all the same. To get closer to a true null world, here we use a new permutation test which randomly assigns each observation (instance of a recorded offence) to a month.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">summer_wildlife_crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">summer</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Wildlife Crime&quot;</span><span class="p">],</span> <span class="p">:]</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                          <span class="o">.</span><span class="n">T</span>
                          <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">())</span>

<span class="n">winter_wildlife_crime</span> <span class="o">=</span> <span class="p">(</span><span class="n">winter</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">idx</span><span class="p">[:,</span><span class="s2">&quot;Wildlife Crime&quot;</span><span class="p">],</span> <span class="p">:]</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">()</span>
                          <span class="o">.</span><span class="n">T</span>
                          <span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="s2">&quot;month&quot;</span><span class="p">)</span>
                          <span class="o">.</span><span class="n">sum</span><span class="p">())</span>
</pre></div>
</div>
</div>
</div>
<p>The problem with this test is that as it produces such a random fake distribution that most of the offences have a huge number of observations which means that a small bias towards winter or summer is still significant compared to a truly random distribution. Unless we pick an offence with very few observations and a small difference the p-value will be far too small to ascertain any useful information.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">better_permutation_test</span><span class="p">(</span><span class="n">summer_rape</span><span class="p">,</span> <span class="n">winter_rape</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(264.3428571428567,
 array([-36.34285714,  14.05714286, -68.91428571, ..., -14.4       ,
         33.6       ,  92.22857143]),
 0.0)
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">stats</span><span class="o">.</span><span class="n">better_permutation_test</span><span class="p">(</span><span class="n">summer_wildlife_crime</span><span class="p">,</span> <span class="n">winter_wildlife_crime</span><span class="p">,</span> <span class="n">alternative</span><span class="o">=</span><span class="s2">&quot;less&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(1.4285714285714288,
 array([-0.97142857,  3.82857143,  1.08571429, ...,  0.05714286,
        -0.62857143, -2.        ]),
 0.25)
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "lisds/project-daylight-robbery",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./pages"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="aviation-security.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Aviation Security (SO18) Borough</p>
      </div>
    </a>
    <a class="right-next"
       href="linear-regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Seasonal Changes Regression Analysis</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#rape">Rape</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#bicycle-theft">Bicycle Theft</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#all-offences">All Offences</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attempting-a-better-permutation-test">Attempting a ‘better’ permutation test</a></li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Pal Patel, Vishal Mistry, Tom Fox
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>