---
jupyter:
  jupytext:
    text_representation:
      extension: .Rmd
      format_name: rmarkdown
      format_version: '1.2'
      jupytext_version: 1.15.2
  kernelspec:
    display_name: Python 3 (ipykernel)
    language: python
    name: python3
---

```{python}
import pandas as pd
```

```{python}
from projtools.data import Data

data = Data()
```

fix lsoa borough names

```{python}
df = pd.read_excel(r"LAD_DEC_2021_UK_NC.xlsx")
df
```

```{python}
map_dict = df.set_index("Code").to_dict()["borough"]
```

```{python}
data.lsoa.index.get_level_values(2)
```

```{python}
new_index_layer = data.lsoa.index.get_level_values(2).map(map_dict)
new_index_layer
```

```{python}
data.lsoa.index = data.lsoa.index.set_levels(data.lsoa.index.levels[2].map(map_dict), level=2)
```

```{python}
data.lsoa
```
